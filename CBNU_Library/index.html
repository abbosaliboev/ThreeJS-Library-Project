<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Pol va Navigatsiya</title>
  <style>
    /* Sahifani to'liq ekran qilib ko'rsatish uchun style */
    body {
      margin: 0;
      overflow: hidden;
    }

    /* 3D sahnani ko'rsatadigan konteyner */
    #scene-container {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="scene-container"></div>

  <!-- Three.js Kutubxonasi -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FontLoader.js"></script>
  
  <script src="three.js"></script>
  <script src="GLTFLoader.js"></script>
  <script src="OrbitControls.js"></script>
  <script>
    // 1. Sahna (Scene) yaratish
    const scene = new THREE.Scene();

    // 2. Kamera yaratish (PerspectiveCamera)
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 3, 10); // Kamerani joylashuvi

    // 3. Renderer yaratish
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight); // Oyna o'lchamiga moslash
    document.getElementById('scene-container').appendChild(renderer.domElement); // Renderer-ni sahifaga qo'shish


    // 4. Yorug'lik qo'shish (DirectionalLight va AmbientLight)
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(0, 10, 10); // Yorug'lik joylashuvi
    scene.add(light);

    // Yumshoq yorug'lik uchun AmbientLight
    const ambientLight = new THREE.AmbientLight(0x404040, 2); // Yorug'lik kuchi
    scene.add(ambientLight);

    // 5. Polni yaratish (xona yeri)
    const textureLoader = new THREE.TextureLoader();
    const floorTexture = textureLoader.load('./images/stone.jpg'); // Kafelli tekstura URL

    // Tekstura takrorlanishini o'rnatish
    floorTexture.wrapS = THREE.RepeatWrapping;
    floorTexture.wrapT = THREE.RepeatWrapping;
    floorTexture.repeat.set(70, 70); // Takrorlash miqdori

    // Pol materiali tekstura bilan
    const floorMaterial = new THREE.MeshStandardMaterial({ map: floorTexture });
    const floorGeometry = new THREE.PlaneGeometry(63, 80);
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2; // Polni yotqizish
    scene.add(floor);


    // TextureLoader yordamida o'tlar teksturasini yuklash
    const textureLoader1 = new THREE.TextureLoader();  // Mana bu yerda `TextureLoader`ni yaratamiz.
    const grassTexture = textureLoader1.load('./images/garden.jpg'); // O'tlar teksturasi



    // bog' ko'kalamzor chap
    const gardenGeometry = new THREE.PlaneGeometry(15, 10);
    const gardenMaterial = new THREE.MeshBasicMaterial({
      map: grassTexture,        // O't teksturasini qo'shish
      side: THREE.DoubleSide
    });
    const garden = new THREE.Mesh(gardenGeometry, gardenMaterial);
    garden.rotation.x = Math.PI / 2;
    garden.position.set(-12, 0.1, 30);  
    scene.add(garden);

// lambert, phong

    // bog' ko'kalamzor o'ng
    const gardenGeometry1 = new THREE.PlaneGeometry(15, 10);
    const gardenMaterial1 = new THREE.MeshBasicMaterial({
      map: grassTexture,        // O't teksturasini qo'shish
      side: THREE.DoubleSide
    });
    const garden1 = new THREE.Mesh(gardenGeometry1, gardenMaterial1);
    garden1.rotation.x = Math.PI / 2;
    garden1.position.set(12, 0.1, 30);  
    scene.add(garden1);


    // orqa bog' ko'kalamzor
    const gardenGeometryBack = new THREE.PlaneGeometry(14, 5);
    const gardenMaterialBack = new THREE.MeshBasicMaterial({
      map: grassTexture,        // O't teksturasini qo'shish
      side: THREE.DoubleSide
    });
    const gardenBack = new THREE.Mesh(gardenGeometryBack, gardenMaterialBack);
    gardenBack.rotation.x = Math.PI / 2;
    gardenBack.position.set(0, 0.1, -30);  
    scene.add(gardenBack);





// Daraxt yaratish funktsiyasi (oddiy dumaloq shakl)
function createSimpleTree(x, z) {
    // Daraxt tanasi (silindr shaklida)
    const trunkGeometry = new THREE.CylinderGeometry(0.15, 0.3, 3, 8); // Oddiy tana qismi
    const trunkTexture = new THREE.TextureLoader().load('./images/bark.jpg'); // Daraxt po'stloq teksturasi
    const trunkMaterial = new THREE.MeshStandardMaterial({ 
        map: trunkTexture
    });

    const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
    trunk.position.set(x, 1.5, z); // Tanani yerga joylashtirish

    // Daraxt barglari (oddiy sfera shaklida)
    const leavesGeometry = new THREE.SphereGeometry(2, 32, 32); // Oddiy sfera barglar uchun
    const leavesTexture = new THREE.TextureLoader().load('./images/leaves.png'); // Barglar uchun tekstura
    const leavesMaterial = new THREE.MeshStandardMaterial({ 
        map: leavesTexture, 
        transparent: true, 
        opacity: 0.9, 
        side: THREE.DoubleSide 
    });

    const leaves = new THREE.Mesh(leavesGeometry, leavesMaterial);
    leaves.position.set(x, 4.5, z); // Barglarni tananing ustiga joylashtirish

    // Daraxtni sahnaga qo'shish
    scene.add(trunk, leaves);
}

// Oddiy daraxt yaratish
createSimpleTree(19, 18);  // oldi
createSimpleTree(-17, 28);  // oldi chap
createSimpleTree(12, 30); // oldi
createSimpleTree(18, -22); // yon o'ng
createSimpleTree(-18, -8);   // yon chap


// Daraxt yaratish funktsiyasi (kichik oddiy dumaloq shaklda)
function createSmallSimpleTree(x, z) {
    // Daraxt tanasi (kichikroq silindr shaklida)
    const trunkGeometry = new THREE.CylinderGeometry(0.1, 0.2, 2, 8); // Kichikroq tana qismi
    const trunkTexture = new THREE.TextureLoader().load('./images/bark.jpg'); // Daraxt po'stloq teksturasi
    const trunkMaterial = new THREE.MeshStandardMaterial({ 
        map: trunkTexture
    });

    const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
    trunk.position.set(x, 1, z); // Tanani yerga joylashtirish

    // Daraxt barglari (kichikroq sfera shaklida)
    const leavesGeometry = new THREE.SphereGeometry(1, 32, 32); // Kichikroq sfera barglar uchun
    const leavesTexture = new THREE.TextureLoader().load('./images/leaves.png'); // Barglar uchun tekstura
    const leavesMaterial = new THREE.MeshStandardMaterial({ 
        map: leavesTexture, 
        transparent: true, 
        opacity: 0.8, 
        side: THREE.DoubleSide 
    });

    const leaves = new THREE.Mesh(leavesGeometry, leavesMaterial);
    leaves.position.set(x, 2.5, z); // Barglarni tananing ustiga joylashtirish

    // Daraxtni sahnaga qo'shish
    scene.add(trunk, leaves);
}

// Kichik oddiy daraxt yaratish
createSmallSimpleTree(-12, 30);
createSmallSimpleTree(18, -25);
createSmallSimpleTree(18, -9);
createSmallSimpleTree(-19, -4);
createSmallSimpleTree(-19, -12);




// Archaga o'xshash daraxt yaratish funktsiyasi (kichikroq versiya)
function createSmallPineTree(x, z) {
    // Daraxt tanasi (kichikroq silindr shaklida)
    const trunkGeometry = new THREE.CylinderGeometry(0.05, 0.1, 2, 8); // Kichikroq tana qismi
    const trunkTexture = new THREE.TextureLoader().load('./images/bark.jpg'); // Daraxt po'stloq teksturasi
    const trunkMaterial = new THREE.MeshStandardMaterial({
        map: trunkTexture
    });

    const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
    trunk.position.set(x, 1, z); // Tanani yerga joylashtirish

    // Archaning barglari (kichikroq konus shaklida)
    function addLayerOfLeaves(yPosition, radius, height) {
        const leavesGeometry = new THREE.ConeGeometry(radius, height, 16); // Kichikroq konus shakli barglar uchun
        const leavesTexture = new THREE.TextureLoader().load('./images/leaves.png'); // Barglar uchun tekstura
        const leavesMaterial = new THREE.MeshStandardMaterial({
            map: leavesTexture, 
            transparent: true, 
            opacity: 0.9,
            side: THREE.DoubleSide 
        });

        const leaves = new THREE.Mesh(leavesGeometry, leavesMaterial);
        leaves.position.set(x, yPosition, z); // Barglarni tanadan yuqoriga joylashtirish
        scene.add(leaves); // Sahnaga qo'shish
    }

    // Kichik archa barglarining qatlamlari
    addLayerOfLeaves(2, 1, 1.5); // Eng katta qatlam (pastki qism)
    addLayerOfLeaves(3, 0.8, 1); // O'rtacha qatlam
    addLayerOfLeaves(3.8, 0.6, 0.8); // Eng kichik qatlam
    addLayerOfLeaves(4.5, 0.4, 0.5); // Tepadagi kichik qatlam

    // Daraxtni sahnaga qo'shish
    scene.add(trunk);
}

// Kichik archaga o'xshash daraxt yaratish
createSmallPineTree(6, -30);
createSmallPineTree(3, -30);
createSmallPineTree(0, -30);
createSmallPineTree(-3, -30);
createSmallPineTree(-6, -30);
createSmallPineTree(18, -5);






// Kichik daraxt yaratish funksiyasi (tekstura bilan)
function createSmallTexturedTree(x, y, z) {
    // Daraxt tanasi teksturasini yuklash
    const trunkTexture = new THREE.TextureLoader().load('./images/bark.jpg'); // Daraxt tanasi uchun tekstura yo'li
    const trunkMaterial = new THREE.MeshStandardMaterial({ map: trunkTexture }); // Tanaga tekstura qo'shish

    // Daraxt tanasi (silindr shakli)
    const smallTrunkGeometry = new THREE.CylinderGeometry(0.1, 0.2, 1); // Kichikroq tana
    const smallTrunk = new THREE.Mesh(smallTrunkGeometry, trunkMaterial);
    smallTrunk.position.set(x, y + 0.5, z); // Daraxt tanasining joylashuvi

    // Daraxt barglari teksturasini yuklash
    const leavesTexture = new THREE.TextureLoader().load('./images/leaves.png'); // Barglar uchun tekstura yo'li
    const leavesMaterial = new THREE.MeshStandardMaterial({ map: leavesTexture }); // Barglarga tekstura qo'shish

    // Barglarni yaratish (kichik sferalar)
    const smallLeafGeometry = new THREE.SphereGeometry(0.5, 16, 16); // Kichik barglar uchun sfera geometriyasi
    const smallLeaf1 = new THREE.Mesh(smallLeafGeometry, leavesMaterial);
    const smallLeaf2 = new THREE.Mesh(smallLeafGeometry, leavesMaterial);
    const smallLeaf3 = new THREE.Mesh(smallLeafGeometry, leavesMaterial);

    // Barglar pozitsiyasini sozlash
    smallLeaf1.position.set(x, y + 1, z); // Pastki barglar
    smallLeaf2.position.set(x, y + 1.6, z); // O'rta barglar
    smallLeaf3.position.set(x, y + 2.2, z); // Yuqori barglar

    // Sahnaga qo'shish
    scene.add(smallTrunk);
    scene.add(smallLeaf1);
    scene.add(smallLeaf2);
    scene.add(smallLeaf3);
}

// Kichik daraxtni yaratish va sahnaga qo'shish
createSmallTexturedTree(9, 0, 0); 
createSmallTexturedTree(9, 0, -3); 
createSmallTexturedTree(9, 0, -6); 
createSmallTexturedTree(9, 0, -18); 
createSmallTexturedTree(9, 0, -21); 
createSmallTexturedTree(9, 0, -24); 
createSmallTexturedTree(-9, 0, -22); 
createSmallTexturedTree(-9, 0, -25); 
createSmallTexturedTree(-9, 0, 2); 
createSmallTexturedTree(-9, 0, 5); 
createSmallTexturedTree(19, 0, -7); 









    // Qora doska yaratish (orqaga doska)
    const boardGeometry = new THREE.BoxGeometry(5, 0.8, 0.1);
    const boardMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Qora rangli doska
    const board = new THREE.Mesh(boardGeometry, boardMaterial);
    board.position.set(0, 2.4, 15.5); // Qora doska joylashuvi
    scene.add(board);

    // Binoning kirish qismiga oq matn qo'shish
    const fontLoader = new THREE.FontLoader();

    fontLoader.load('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/fonts/helvetiker_regular.typeface.json', function (font) {
      const textGeometry = new THREE.TextGeometry('C B N U - L I B R A R Y', {
        font: font,
        size: 0.3, // Matn kattaligi kichikroq qilindi
        height: 0.12, // Bo'rtib chiqadigan miqdor 0.3
        curveSegments: 12, // Tekis matn uchun segmentlar soni
        bevelEnabled: true, // Bo'rtma
        bevelThickness: 0.05, // Bo'rtma qalinligi
        bevelSize: 0.02, // Bo'rtma o'lchami
        bevelOffset: 0,
        bevelSegments: 3 // Bo'rtma segmentlari
      });

      // Oq matn materiali
      const textMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff }); // Oq matn rangi
      const textMesh = new THREE.Mesh(textGeometry, textMaterial);
      
      // Matnni doskaga joylashtirish
      textMesh.position.set(-2.1, 2.25, 15.5); // Matn doskada joylashgan (X, Y, Z)
      scene.add(textMesh); // Matnni sahnaga qo'shish
    });




    // 6. Avtomobil yo'li teksturasini yuklash
    const textureLoaderRoad = new THREE.TextureLoader();
    const roadTextureRoad = textureLoaderRoad.load('./images/road.jpg'); // Yo'l teksturasi

    // Teksturaning takrorlanishini sozlash
    roadTextureRoad.wrapS = THREE.RepeatWrapping;
    roadTextureRoad.wrapT = THREE.RepeatWrapping;
    roadTextureRoad.repeat.set(10, 1); // Uzunroq yo'l effektini yaratish uchun takrorlanish

    // 7. Avtomobil yo'lini yaratish
    const roadGeometryRoad = new THREE.PlaneGeometry(80, 5); // Uzun yo'lning kengligi va uzunligi
    const roadMaterialRoad = new THREE.MeshStandardMaterial({ map: roadTextureRoad });
    
    // Chap yo'l
    const road1 = new THREE.Mesh(roadGeometryRoad, roadMaterialRoad);
    road1.rotation.x = -Math.PI / 2; // Yo'lni yer bilan parallel qilish
    road1.rotation.z = 45 * (Math.PI / 90);
    road1.position.set(-27, 0.02, 0); 
    scene.add(road1);

    // O'ng yo'l
    const road2 = new THREE.Mesh(roadGeometryRoad, roadMaterialRoad);
    road2.rotation.x = -Math.PI / 2; // Yo'lni yer bilan parallel qilish
    road2.rotation.z = 45 * (Math.PI / 90);
    road2.position.set(27, 0.02, 0); 
    scene.add(road2);

    // 6. Adding OrbitControls (Camera control with a trackball) 
    const controls = new THREE.OrbitControls(camera, renderer.domElement); 
    controls.enableDamping = true; // Inertia effect 
    controls.dampingFactor = 0.05;  
    controls.enableZoom = true; // Zoom (zoom in/out) 

    const moveSpeed = 0.1; 
    const keys = { 
        forward: false, 
        backward: false, 
        left: false, 
        right: false 
    }; 

    window.addEventListener('keydown', (event) => { 
        switch (event.code) { 
        case 'KeyW': keys.forward = true; break; 
        case 'KeyS': keys.backward = true; break; 
        case 'KeyA': keys.left = true; break; 
        case 'KeyD': keys.right = true; break; 
        } 
    }); 

    window.addEventListener('keyup', (event) => { 
        switch (event.code) { 
        case 'KeyW': keys.forward = false; break; 
        case 'KeyS': keys.backward = false; break; 
        case 'KeyA': keys.left = false; break; 
        case 'KeyD': keys.right = false; break; 
        } 
    }); 

    function updateMovement() { 
        const direction = new THREE.Vector3(); 
        if (keys.forward) direction.z -= moveSpeed; 
        if (keys.backward) direction.z += moveSpeed; 
        if (keys.left) direction.x -= moveSpeed; 
        if (keys.right) direction.x += moveSpeed; 
        direction.applyQuaternion(camera.quaternion); 
        camera.position.add(direction); 
    } 

    // Stopping movement when releasing the keyboard key 
    window.addEventListener('keyup', (event) => { 
        switch (event.code) { 
        case 'KeyW': 
            keys.forward = false; // Stop forward movement 
            break; 
        case 'KeyS': 
            keys.backward = false; // Stop backward movement 
            break; 
        case 'KeyA': 
            keys.left = false; // Stop left movement 
            break; 
        case 'KeyD': 
            keys.right = false; // Stop right movement 
            break; 
        } 
    }); 

        // Animation funksion 
    function animate() { 
        requestAnimationFrame(animate); 
        updateMovement(); 
        controls.update(); 
        renderer.render(scene, camera); 
    }


// Binoning materiali uchun tekstura yuklash
const buildingTexture = new THREE.TextureLoader().load('./images/LibTile.jpg'); // Tekstura fayli
buildingTexture.wrapS = THREE.RepeatWrapping; // Gorizontal bo'yicha takrorlash
buildingTexture.wrapT = THREE.RepeatWrapping; // Vertikal bo'yicha takrorlash
buildingTexture.repeat.set(50, 10); // Tekstura X va Y o'qlari bo'yicha bir necha marta takrorlanadi (bu qiymatni moslashtirish mumkin)

// Binoning materiali (tekstura bilan)
const buildingMaterial = new THREE.MeshLambertMaterial({ map: buildingTexture });

// Binoning asosiy geometriyasi (to'rtburchak shaklida)
const buildingGeometry = new THREE.BoxGeometry(28, 10, 8);  // Bino kengligi, balandligi, chuqurligi
const building = new THREE.Mesh(buildingGeometry, buildingMaterial);
scene.add(building);

// Binoning joylashuvini o'zgartirish
building.position.set(0, 7.5, 10);  // Binoni markazlash




// Binoning tom materiali (oddiy qora rang)
const buildingMaterial1 = new THREE.MeshLambertMaterial({ color: 0x333333 });

// Binoning tepa tom geometriyasi (to'rtburchak shaklida)
const buildingGeometry1 = new THREE.BoxGeometry(28, 0.5, 8);  // Bino kengligi, balandligi, chuqurligi
const building1 = new THREE.Mesh(buildingGeometry1, buildingMaterial1);
scene.add(building1);

// Tom joylashuvini o'zgartirish
building1.position.set(0, 13.5, 10);  // Binoni markazlash, Y: 5, bu bino pastki qismini yerga joylashtiradi



// Binoning 2 tom materiali (oddiy qora rang)
const buildingMaterial2 = new THREE.MeshLambertMaterial({ color: 0x333333 });

// Binoning 2 tepa tom geometriyasi (to'rtburchak shaklida)
const buildingGeometry2 = new THREE.BoxGeometry(26, 1, 7);  // Bino kengligi, balandligi, chuqurligi
const building2 = new THREE.Mesh(buildingGeometry2, buildingMaterial2);
scene.add(building2);

// 2 Tom joylashuvini o'zgartirish
building2.position.set(0, 14, 10);  // Binoni markazlash, Y: 5, bu bino pastki qismini yerga joylashtiradi






// ---------------------------------- animation --------------------------------------------

function loadCarModel(scene) {
    const loader = new THREE.GLTFLoader();

    loader.load('scene.gltf', function (gltf) {
        const car = gltf.scene;
        car.scale.set(0.02, 0.02, 0.02); // Avtomobil hajmini moslashtirish
        car.position.set(27, 0, 35); // Avtomobilni boshlang'ich joyga joylashtirish
        car.rotation.y = Math.PI / 1; // Kerakli yo'nalishda burish
        scene.add(car); // Sahnaga avtomobilni qo'shish

// Avtomobil boshqaruvini yoqish
enableCarControl(car);

// Kamera boshqaruvini yoqish
enableCameraControl(camera, controls);

    }, undefined, function (error) {
        console.error('Error:', error);
    });
}

function enableCarControl(car) {
    let isDriving = false; // Foydalanuvchi boshqaruv rejimi

    // "Car Drive" tugmasi
    const driveButton = document.createElement('button');
    driveButton.innerHTML = 'Car Drive';
    driveButton.style.position = 'absolute';
    driveButton.style.top = '10px';
    driveButton.style.right = '10px';
    driveButton.style.padding = '10px 20px';
    driveButton.style.backgroundColor = '#007BFF';
    driveButton.style.color = 'white';
    driveButton.style.border = 'none';
    driveButton.style.borderRadius = '5px';
    driveButton.style.cursor = 'pointer';
    document.body.appendChild(driveButton);

    const keys = {
        forward: false,
        backward: false,
        left: false,
        right: false
    };

    // Klaviatura boshqaruvi
    const keyDownHandler = (event) => {
        if (isDriving) {
            switch (event.code) {
                case 'ArrowUp':
                    keys.backward = true;
                    break;
                case 'ArrowDown':
                    keys.forward = true;
                    break;
                case 'ArrowLeft':
                    keys.left = true;
                    break;
                case 'ArrowRight':
                    keys.right = true;
                    break;
            }
        }
    };

    const keyUpHandler = (event) => {
        if (isDriving) {
            switch (event.code) {
                case 'ArrowUp':
                    keys.backward = false;
                    break;
                case 'ArrowDown':
                    keys.forward = false;
                    break;
                case 'ArrowLeft':
                    keys.left = false;
                    break;
                case 'ArrowRight':
                    keys.right = false;
                    break;
            }
        }
    };

    function updateCarMovement() {
        const speed = 0.2;
        const rotationSpeed = 0.03;

        if (keys.forward) {
            car.position.z -= Math.cos(car.rotation.y) * speed; // Oldinga harakat
            car.position.x -= Math.sin(car.rotation.y) * speed;
        }
        if (keys.backward) {
            car.position.z += Math.cos(car.rotation.y) * speed; // Orqaga harakat
            car.position.x += Math.sin(car.rotation.y) * speed;
        }
        if (keys.left) {
            car.rotation.y += rotationSpeed; // Chapga burilish
        }
        if (keys.right) {
            car.rotation.y -= rotationSpeed; // O'ngga burilish
        }

        if (isDriving) {
            requestAnimationFrame(updateCarMovement); // Faqat boshqaruv rejimida yangilash
        }
    }

    driveButton.addEventListener('click', () => {
        isDriving = !isDriving; // Boshqaruv rejimini yoqish/o'chirish
        driveButton.innerHTML = isDriving ? 'Stop Driving' : 'Car Drive';

        if (isDriving) {
            window.addEventListener('keydown', keyDownHandler); // Klaviatura hodisalarini qo'shish
            window.addEventListener('keyup', keyUpHandler);
            updateCarMovement(); // Harakatni yangilashni boshlash
        } else {
            window.removeEventListener('keydown', keyDownHandler); // Klaviatura hodisalarini o'chirish
            window.removeEventListener('keyup', keyUpHandler);
        }
    });
}

// Kamera boshqaruvi uchun kod
function enableCameraControl(camera, controls) {
    const keys = {
        forward: false,
        backward: false,
        left: false,
        right: false
    };

    window.addEventListener('keydown', (event) => {
        switch (event.code) {
            case 'KeyW':
                keys.forward = true;
                break;
            case 'KeyS':
                keys.backward = true;
                break;
            case 'KeyA':
                keys.left = true;
                break;
            case 'KeyD':
                keys.right = true;
                break;
        }
    });

    window.addEventListener('keyup', (event) => {
        switch (event.code) {
            case 'KeyW':
                keys.forward = false;
                break;
            case 'KeyS':
                keys.backward = false;
                break;
            case 'KeyA':
                keys.left = false;
                break;
            case 'KeyD':
                keys.right = false;
                break;
        }
    });

    function updateCameraMovement() {
        const speed = 0.3;

        if (keys.forward) {
            camera.position.z -= speed;
        }
        if (keys.backward) {
            camera.position.z += speed;
        }
        if (keys.left) {
            camera.position.x -= speed;
        }
        if (keys.right) {
            camera.position.x += speed;
        }

        requestAnimationFrame(updateCameraMovement);
    }

    updateCameraMovement();
}



// Avtomobilni yuklash
loadCarModel(scene);


// Animatsiya funksiyasi
function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
}



// ----
// 1. GLTFLoader orqali avtomobilni yuklash funksiyasi
function loadSecondCar(scene) {
    const loader = new THREE.GLTFLoader();

    loader.load(
        './scene.gltf', // 2-chi avtomobil modeli fayli yo'li
        function (gltf) {
            const car = gltf.scene;

            // Avtomobilni joylashuvi va masshtabini sozlash
            car.position.set(-27, 0, 35);
            car.scale.set(0.02, 0.02, 0.02); // Avtomobil hajmini moslashtirish

            // Avtomobilni sahnaga qo'shish
            scene.add(car);

            // Avtomobilni animatsiya qilish
            animateSecondCar(car);
        },
        undefined,
        function (error) {
            console.error('2-chi modelni yuklashda xatolik yuz berdi:', error);
        }
    );
}

// 2. Avtomobil harakati uchun animatsiya funksiyasi
function animateSecondCar(car) {
    let direction = 1; // Harakat yo'nalishi (oldinga yoki orqaga)
    const speed = 0.1; // Harakat tezligi
    const boundary = 20; // Harakat chegarasi

    function moveCar() {
        car.position.z += speed; // X o'qida oldinga harakat

        if (car.position.z > 27) {
            car.position.z = -27; // Chegaraga yetganda boshiga qaytadi
        }

        requestAnimationFrame(moveCar); // Harakatni davom ettirish
    }

    moveCar(); // Animatsiyani boshlash
}

// 3. GLTFLoaderni ishlatib ikkinchi avtomobilni yuklash
loadSecondCar(scene); // Avtomobilning pozitsiyasi va masshtabi



// Materials
const metalMaterial = new THREE.MeshPhysicalMaterial({
  color: 0x9ba4b5,
  metalness: 0.9,
  roughness: 0.2,
  clearcoat: 0.8,
  clearcoatRoughness: 0.2,
});

const darkMetalMaterial = new THREE.MeshPhysicalMaterial({
  color: 0x394867,
  metalness: 0.9,
  roughness: 0.3,
  clearcoat: 0.5,
  clearcoatRoughness: 0.2,
});

const seatMaterial = new THREE.MeshPhysicalMaterial({
  color: 0x212a3e,
  metalness: 0.3,
  roughness: 0.7,
  clearcoat: 0.3,
});

const transparentMaterial = new THREE.MeshPhysicalMaterial({
  color: 0xe5e9f0,
  transmission: 0.9,
  opacity: 0.3,
  metalness: 0.2,
  roughness: 0.05,
  ior: 1.5,
  transparent: true,
  thickness: 0.5,
});

const tableMaterial = new THREE.MeshPhysicalMaterial({
  color: 0xe5e9f0,
  metalness: 0.8,
  roughness: 0.2,
  clearcoat: 1.0,
  clearcoatRoughness: 0.1,
});

// Create base group
const booth = new THREE.Group();

// Base platform
const baseGeometry = new THREE.BoxGeometry(4.2, 0.2, 4.2);
const base = new THREE.Mesh(baseGeometry, metalMaterial);
base.position.y = -0.1;
booth.add(base);

// Curved Roof
const roofShape = new THREE.Shape();
roofShape.moveTo(-2.1, 0);
roofShape.quadraticCurveTo(0, 2, 2.1, 0);

const roofExtrudeSettings = {
  steps: 32,
  depth: 4.2,
  bevelEnabled: true,
  bevelThickness: 0.05,
  bevelSize: 0.05,
  bevelSegments: 5,
};

const roofGeometry = new THREE.ExtrudeGeometry(roofShape, roofExtrudeSettings);
const roofMaterial = new THREE.MeshPhysicalMaterial({
  color: 0xdaa520, // Gold-like color for the roof
  metalness: 0.9,
  roughness: 0.3,
});
const roof = new THREE.Mesh(roofGeometry, roofMaterial);
roof.position.set(0, 3, -2);
booth.add(roof);

// Seats
const createSeat = (x, z) => {
  const seatBaseGeometry = new THREE.BoxGeometry(1.8, 0.15, 0.6);
  const seatBase = new THREE.Mesh(seatBaseGeometry, seatMaterial);
  seatBase.position.set(x, 0.3, z);
  booth.add(seatBase);

  const seatBackGeometry = new THREE.BoxGeometry(1.8, 0.7, 0.1);
  const seatBack = new THREE.Mesh(seatBackGeometry, seatMaterial);
  seatBack.position.set(x, 0.7, z - 0.3);
  booth.add(seatBack);
};

createSeat(-1, -1.4);
createSeat(1, -1.4);

// Table
const tableTopGeometry = new THREE.BoxGeometry(1.2, 0.05, 0.8);
const tableTop = new THREE.Mesh(tableTopGeometry, tableMaterial);
tableTop.position.set(0, 0.8, -1.4);
booth.add(tableTop);

const tableLegGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.7);
const tableLeg = new THREE.Mesh(tableLegGeometry, darkMetalMaterial);
tableLeg.position.set(0, 0.45, -1.4);
booth.add(tableLeg);

// Trash Bin
const trashBinGeometry = new THREE.CylinderGeometry(0.2, 0.2, 0.8);
const trashBin = new THREE.Mesh(trashBinGeometry, darkMetalMaterial);
trashBin.position.set(-1.8, 0.4, 1.8);
booth.add(trashBin);

const trashBinLidGeometry = new THREE.TorusGeometry(0.2, 0.03, 16, 32);
const trashBinLid = new THREE.Mesh(trashBinLidGeometry, metalMaterial);
trashBinLid.position.set(-1.8, 0.8, 1.8);
trashBinLid.rotation.x = Math.PI / 2;
booth.add(trashBinLid);

// Glass Panels
const createGlassPanel = (x, z, rotation) => {
  const glassPanelGeometry = new THREE.BoxGeometry(3.8, 2.5, 0.05);
  const tintedGlassMaterial = new THREE.MeshPhysicalMaterial({
    color: 0x000000,
    transmission: 0.7,
    opacity: 0.6,
    transparent: true,
  });
  const glassPanel = new THREE.Mesh(glassPanelGeometry, tintedGlassMaterial);
  glassPanel.position.set(x, 1.3, z);
  glassPanel.rotation.y = rotation;
  booth.add(glassPanel);
};

createGlassPanel(0, -2.1, 0);
createGlassPanel(-2.1, 0, Math.PI / 2);
createGlassPanel(2.1, 0, Math.PI / 2);

// Chimney for Smoke
const chimneyGeometry = new THREE.CylinderGeometry(0.1, 0.1, 0.8, 16);
const chimneyMaterial = new THREE.MeshPhysicalMaterial({
  color: 0x2c3e50,
  metalness: 0.7,
  roughness: 0.4,
});
const chimney = new THREE.Mesh(chimneyGeometry, chimneyMaterial);
chimney.position.set(0, 3.8, -1.5);
booth.add(chimney);

// Smoke Particles
const smokeParticles = [];
const smokeGeometry = new THREE.SphereGeometry(0.2, 16, 16); // Increased size
const smokeMaterial = new THREE.MeshStandardMaterial({
  color: 0xdddddd,
  transparent: true,
  opacity: 0.9, // Increased opacity for visibility
  emissive: 0xaaaaaa,
  emissiveIntensity: 0.5,
});

const createSmoke = () => {
  const smoke = new THREE.Mesh(smokeGeometry, smokeMaterial);
  smoke.position.set(0, 4.2, -1.5); // Position above the chimney
  booth.add(smoke);
  smokeParticles.push(smoke);
};

// Animate Smoke
const animateSmoke = () => {
  smokeParticles.forEach((smoke, index) => {
    smoke.position.y += 0.02; // Rise speed
    smoke.material.opacity -= 0.005; // Gradual fade
    if (smoke.material.opacity <= 0) {
      booth.remove(smoke); // Remove faded particles
      smokeParticles.splice(index, 1);
    }
  });
  requestAnimationFrame(animateSmoke);
};

// Generate Smoke at Intervals
setInterval(() => {
  createSmoke();
}, 300); // New smoke particle every 300ms

// Lighting to Ensure Visibility
const smokeLight = new THREE.PointLight(0xffffff, 0.3); // Add light near the chimney
smokeLight.position.set(0, 4.5, -1.5);
booth.add(smokeLight);

// Call animation
animateSmoke();


// Add everything to the scene
scene.add(booth);

booth.position.set(-18, 0.1, -19);


// --------------------------------- animation end ------------------------------------------


// ------------------------------------------------Back Building-------------------------------------------------------------

// TextureLoader yordamida rasmni yuklash
const textureLoaderBack = new THREE.TextureLoader();
const backgroundTexture = textureLoaderBack.load('./images/backround.jpeg'); // Rasm yo'lini kiriting

// Sahna fonini o'rnatish
scene.background = backgroundTexture;



// Binoning orqa qismi materiali (oddiy qora rang)
const buildingMaterial3 = new THREE.MeshLambertMaterial({ color: 0xffffff });

// Binoning orqa qismi geometriyasi (to'rtburchak shaklida)
const buildingGeometry3 = new THREE.BoxGeometry(14, 12, 28);  // Bino kengligi, balandligi, chuqurligi
const building3 = new THREE.Mesh(buildingGeometry3, buildingMaterial3);
scene.add(building3);

// Binoning orqa qismi joylashuvini o'zgartirish
building3.position.set(0, 6, -12);  // Binoni markazlash, Y: 5, bu bino pastki qismini yerga joylashtiradi




// Font yuklash va "UNIVERSITY LIBRARY" yozuvini yaratish
const customFontLoader = new THREE.FontLoader();

customFontLoader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function (customFont) {
    // "UNIVERSITY LIBRARY" yozuvining geometriyasini yaratish
    const universityTextGeometry = new THREE.TextGeometry('N 1 2  -  C B N U   L I B R A R Y', {
        font: customFont,
        size: 0.3, // Yozuvning kattaligi
        height: 0.05, // Bo'rtib chiqadigan miqdor
        curveSegments: 12, // Silliqroq ko'rinishi uchun segmentlar soni
        bevelEnabled: true, // Bo'rtma effektini yoqish
        bevelThickness: 0.01, // Bo'rtma qalinligi
        bevelSize: 0.02, // Bo'rtma kattaligi
        bevelSegments: 2 // Bo'rtma segmentlari
    });

    // Yozuv materiali (oq rang)
    const universityTextMaterial = new THREE.MeshBasicMaterial({ color: 0xabccff });
    const leftTextMesh = new THREE.Mesh(universityTextGeometry, universityTextMaterial);

    // Yozuvning birinchi yon tomonga joylashuvi (chap tomonda)
    leftTextMesh.position.set(-7, 11, -17); // Binoning chap yon qismi
    leftTextMesh.rotation.y = -Math.PI / 2; // Yozuvni y o'qida aylantirish

    // Yozuvni sahnaga qo'shish
    scene.add(leftTextMesh);

    // Yozuvning ikkinchi yon tomonga joylashuvi (o'ng tomonda)
    const rightTextMesh = new THREE.Mesh(universityTextGeometry, universityTextMaterial);
    rightTextMesh.position.set(7, 11, -11.3); // Binoning o'ng yon qismi
    rightTextMesh.rotation.y = Math.PI / 2; // Yozuvni y o'qida aylantirish

    // Yozuvni sahnaga qo'shish
    scene.add(rightTextMesh);
});





// Tekstura yuklash
const wallTexture = new THREE.TextureLoader().load('./images/coffee.jpg');

// Tekstura takrorlanishini o'rnatish
wallTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
wallTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
wallTexture.repeat.set(1, 1); // Tekstura 10x10 marta takrorlanadi

// Material yaratish (tekstura bilan)
const wallMaterial = new THREE.MeshBasicMaterial({ map: wallTexture });

// Geometriya yaratish (devor o'lchami bilan mos)
const wallGeometry = new THREE.PlaneGeometry(6, 3); // Devor 10x10 o'lchamda

// Devor (mesh) yaratish
const wall = new THREE.Mesh(wallGeometry, wallMaterial);

// Devorning pozitsiyasini o'rnatish
wall.position.set(-3, 2.5, 2.05); // Pozitsiyani kerakli joyga o'rnating

// Devorni sahnaga qo'shish
scene.add(wall);







// Binoning devorlariga tekstura qo'shish va teksturani bir necha bor qaytarish
function createBuildingWithTextures() {
    // Devorlar uchun tekstura yuklash
    const wallTexture = new THREE.TextureLoader().load('./images/LibTile.jpg'); // Devorlar uchun tekstura
    wallTexture.wrapS = THREE.RepeatWrapping; // Gorizontal bo'yicha takrorlash
    wallTexture.wrapT = THREE.RepeatWrapping; // Vertikal bo'yicha takrorlash
    wallTexture.repeat.set(50, 20); // Tekstura X va Y o'qlari bo'yicha 10 marta qaytariladi

    const wallMaterial = new THREE.MeshLambertMaterial({ map: wallTexture, side: THREE.DoubleSide }); // Har ikki tomon ko'rinadigan material

    // Bino geometriyasi (to'rtburchak shaklida)
    const buildingGeometry = new THREE.BoxGeometry(14, 12, 28); // Bino kengligi, balandligi, chuqurligi
    const building = new THREE.Mesh(buildingGeometry, wallMaterial);
    scene.add(building);

    // Binoning joylashuvi
    building.position.set(0, 6, -12);  // Binoni markazlash

    // Oynalar uchun tekstura yuklash
    const windowTexture = new THREE.TextureLoader().load('./images/window.jpg'); // Yuklangan oyna teksturasi
    const windowMaterial = new THREE.MeshLambertMaterial({ map: windowTexture, side: THREE.DoubleSide });

    // Eshik uchun tekstura yuklash
    const doorTexture = new THREE.TextureLoader().load('./images/doorRight.jpg'); // Yuklangan eshik teksturasi
    const doorMaterial = new THREE.MeshLambertMaterial({ map: doorTexture, side: THREE.DoubleSide });

// Oynalar yaratish (3x3 tartibda)
for (let row = 0; row < 3; row++) { // Vertikal bo'ylab 3 qator yaratish
    for (let col = 0; col < 3; col++) { // Har bir qator uchun 3 tadan oyna joylashtirish
        const windowGeometry = new THREE.PlaneGeometry(2, 1.7); // Oynaning o'lchami
        const windowMeshRight = new THREE.Mesh(windowGeometry, windowMaterial);

        // O'ng tomonga oynalarni joylashtirish
        windowMeshRight.position.set(-7.03, 9.5 - row * 3.5, -6.5 + col * 3); // Oynalarning pozitsiyasi: X, Y, Z koordinatalar
        windowMeshRight.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMeshRight);

        // Chap tomonga oynalarni joylashtirish
        const windowMeshLeft = new THREE.Mesh(windowGeometry, windowMaterial);
        windowMeshLeft.position.set(7.03, 9.5 - row * 3.5, -6.5 + col * 3); // Oynalarning pozitsiyasi: X, Y, Z koordinatalar
        windowMeshLeft.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMeshLeft);
    }
}

// Oynalar yaratish (2x2 tartibda)
for (let row = 0; row < 3; row++) { // Vertikal bo'ylab 3 qator yaratish
    for (let col = 0; col < 2; col++) { // Har bir qator uchun 3 tadan oyna joylashtirish
        const windowGeometry = new THREE.PlaneGeometry(1.5, 1.7); // Oynaning o'lchami
        const windowMeshRight = new THREE.Mesh(windowGeometry, windowMaterial);

        // O'ng tomonga oynalarni joylashtirish
        windowMeshRight.position.set(-7.03, 9.5 - row * 3.5, -24 + col * 2); // Oynalarning pozitsiyasi: X, Y, Z koordinatalar
        windowMeshRight.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMeshRight);

        // Chap tomonga oynalarni joylashtirish
        const windowMeshLeft = new THREE.Mesh(windowGeometry, windowMaterial);
        windowMeshLeft.position.set(7.03, 9.5 - row * 3.5, -24 + col * 2); // Oynalarning pozitsiyasi: X, Y, Z koordinatalar
        windowMeshLeft.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMeshLeft);
    }
}

   // Mayda oynalar yaratish
    for (let i = 0; i < 6; i++) {
        const windowGeometry = new THREE.PlaneGeometry(0.8, 0.8); // Oynaning o'lchami
        const windowMesh = new THREE.Mesh(windowGeometry, windowMaterial);

        windowMesh.position.set(-7.03, 9.5, -18.1 + i * 1.5); // O'ng tomonga oynalarni joylashtirish
        windowMesh.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMesh);

        const windowMeshLeft = new THREE.Mesh(windowGeometry, windowMaterial);
        windowMeshLeft.position.set(7.03, 9.5, -18 + i * 1.5); // Chap tomonga oynalarni joylashtirish
        windowMeshLeft.rotation.y = Math.PI / 2; // Oynalarni Y o'qida 90 gradusga aylantirish
        scene.add(windowMeshLeft);
    }


// Orqa oynalar yaratish (3x3 tartibda)
for (let row = 0; row < 3; row++) { // Vertikal bo'ylab 3 qator yaratish
    for (let col = 0; col < 4; col++) { // Har bir qator uchun 3 tadan oyna joylashtirish
        const windowGeometry = new THREE.PlaneGeometry(2, 1.7); // Oynaning o'lchami
        const windowMeshRight = new THREE.Mesh(windowGeometry, windowMaterial);

        // Bir tomonga oynalarni joylashtirish
        windowMeshRight.position.set( -4.4 + col * 3, 9.5 - row * 3.5, -26.03); // Oynalarning pozitsiyasi: X, Y, Z koordinatalar
        scene.add(windowMeshRight);
    }
}


    // Eshiklar yaratish (chap va o'ng tomonlarga)
    const doorGeometry = new THREE.PlaneGeometry(12, 8); // Eshik o'lchami
    const doorMeshLeft = new THREE.Mesh(doorGeometry, doorMaterial);
    doorMeshLeft.position.set(-7.01, 4, -14.5); // Chap tomonga eshik qo'yish
    doorMeshLeft.rotation.y = Math.PI / 2; // Eshiklarni Y o'qida 90 gradusga aylantirish
    scene.add(doorMeshLeft);

    const doorMeshRight = new THREE.Mesh(doorGeometry, doorMaterial);
    doorMeshRight.position.set(7.01, 4, -14.5); // O'ng tomonga eshik qo'yish
    doorMeshRight.rotation.y = Math.PI / 2; // Eshiklarni Y o'qida 90 gradusga aylantirish
    scene.add(doorMeshRight);
}

// Binoni chaqirish: devor teksturalari, oynalar va eshiklar
createBuildingWithTextures();





// ------------------------------------------------           -------------------------------------------------------------



// Oynali qavat yaratish (yangi ramkalar bilan, ichida ramkalar yo'q)
const glassMaterial = new THREE.MeshLambertMaterial({
    color: 0x222222,
    transparent: true,
    opacity: 0.6
});  // Yarim shaffof oynali material
const glassGeometry = new THREE.BoxGeometry(26, 3, 7);
const glassFloor = new THREE.Mesh(glassGeometry, glassMaterial);
glassFloor.position.set(0, 1, 10);
scene.add(glassFloor);



// Ramka yaratish uchun material (ko'zga tashlanmas, quyuq kulrang rang)
const frameMaterial = new THREE.MeshLambertMaterial({ color: 0x333333 });  // Ko'zga kamroq tashlanadigan kulrang material

// Ramka elementlarini yaratish (faqat tashqi tomonda, kirish qismidagi chiziqlarni chetlab o'tish)
function createFrame(x, y, z, width, height, depth) {
    // Kirish qismidagi X va Z o'qlaridagi hududlarni aniqlash
    if (z === 13.5 && x > -2.5 && x < 2.5) {
        // Bu if shartida kirish qismidagi ramkalar hosil qilinmaydi
        return; // Kirish joyida chiziqlar hosil qilinmaydi
    }
    const frameGeometry = new THREE.BoxGeometry(width, height, depth);  // Ramka uchun tor geometriya
    const frame = new THREE.Mesh(frameGeometry, frameMaterial);
    frame.position.set(x, y, z);  // Ramka pozitsiyasini belgilash
    scene.add(frame);  // Ramkani sahnaga qo'shish
}

// Ramkalarni qo'shish jarayoni
const frameThickness = 0.05;  // Ramkaning qalinligi (ingichka qilib o'rnatiladi)
const numVerticalLines = 20;  // Vertikal chiziqlar soni

// Gorizontal chiziqlarni kirish qismida to'xtatish
function createHorizontalFrameWithGap(y, z, gapStart, gapEnd) {
    // Gorizontal ramkani yaratish, lekin kirish joyida (gapStart - gapEnd) oralig'ida to'xtatish
    const leftWidth = gapStart + 15; // Chap tomondagi chiziq uzunligi
    const rightWidth = 15 - gapEnd;  // O'ng tomondagi chiziq uzunligi

    // Chap tomondan kirish joyiga qadar gorizontal chiziq
    createFrame(-13 + leftWidth / 2, y, z, leftWidth, frameThickness, frameThickness);

    // O'ng tomondan kirish joyiga qadar gorizontal chiziq
    createFrame(gapEnd - 2 + rightWidth / 2, y, z, rightWidth, frameThickness, frameThickness);
}

const numVerticalLinesSide = 6;  // Vertikal chiziqlar soni
// Yon tomonlardagi vertikal chiziqlarni yaratish funksiyasi
function createVerticalFramesOnSides() {
    const sideZ = 10; // Bu Z o'qida yon tomonlardagi chiziqlar uchun to'g'ri Z koordinatasi

    // Chap tomondagi vertikal chiziqlar (yon tomon)
    for (let i = 1; i < numVerticalLinesSide; i++) {
        const xPos = (i * (7 / numVerticalLinesSide)) - 3.5; // X koordinatani belgilash
        createFrame(-13, 1, xPos + sideZ, frameThickness, 3, frameThickness); // Chap tomondagi vertikal ramkalar
    }

    // O'ng tomondagi vertikal chiziqlar (yon tomon)
    for (let i = 1; i < numVerticalLinesSide; i++) {
        const xPos = (i * (7 / numVerticalLinesSide)) - 3.5; // X koordinatani belgilash
        createFrame(13, 1, xPos + sideZ, frameThickness, 3, frameThickness); // O'ng tomondagi vertikal ramkalar
    }
}


// Gorizontal chiziqlarni qo'shish (kirish qismi uchun to'xtatilgan holda)
createHorizontalFrameWithGap(1.7, 13.5, -5, 5);  // Yuqori gorizontal chiziq
createHorizontalFrameWithGap(0.7, 13.5, -5, 5);  // Pastki gorizontal chiziq



// Yon tomonlardagi ramkalar (ingichka qilib)
createFrame(-13, 1.7, 10, frameThickness, frameThickness, 7); // Yuqori gorizontal ramka (yon tomonda)
createFrame(-13, 0.7, 10, frameThickness, frameThickness, 7); // Pastki gorizontal ramka (yon tomonda)
createFrame(13, 1.7, 10, frameThickness, frameThickness, 7);  // O'ng yuqori gorizontal ramka (yon tomonda)
createFrame(13, 0.7, 10, frameThickness, frameThickness, 7);  // O'ng pastki gorizontal ramka (yon tomonda)

// Tashqi tomonda vertikal chiziqlarni ko'proq qilish
for (let i = 1; i < numVerticalLines ; i++) {
    const xPos = (i * (26 / numVerticalLines)) - 16; // Vertikal chiziqlarni o'rnatish uchun X koordinatasi
    createFrame(xPos + 2.6, 1, 13.5, frameThickness, 3, frameThickness);  // Old tomondagi vertikal ramkalar

}

// Yon tomonlarga vertikal ramkalarni qo'shish
createVerticalFramesOnSides();









// Ichki Pol Tekstura yuklash (faqat bir marta yuklanadi va keyingi pol uchun ishlatiladi)
const customTextureLoader = new THREE.TextureLoader();
const libraryFloorTexture = customTextureLoader.load('./images/tileDark.jpg');

//  Ichki Pol Tekstura takrorlanishini sozlash (har doim bir xil bo'ladi)
libraryFloorTexture.wrapS = THREE.RepeatWrapping;
libraryFloorTexture.wrapT = THREE.RepeatWrapping;
libraryFloorTexture.repeat.set(40, 10); // Takrorlanish miqdori (moslashtirish mumkin)

// Ichki Pol qo'shish uchun funksiyani yaratish
function addLibraryFloor(width, height, positionX, positionY, positionZ) {
    // 1. Pol geometriyasi va materiali yaratish
    const floorGeometry = new THREE.PlaneGeometry(width, height); // Polning o'lchamini kerakli qiymatga moslashtirish
    const floorMaterial = new THREE.MeshStandardMaterial({ map: libraryFloorTexture });

    // 2. Polni yaratish va joylashtirish
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2; // Polni yerga yotqizish
    floor.position.set(positionX, positionY, positionZ); // Pozitsiyani moslashtirish

    // 3. Polni sahnaga qo'shish
    scene.add(floor);
}

// Yangi pol qo'shish
addLibraryFloor(25.9, 6.9, 0, 0.005, 10.05); // Kirish qismdagi pol o'lchami va position 
addLibraryFloor(12, 4.6, 0, 0.005, 4.3); // o'rta qismdagi pol o'lchami va position
addLibraryFloor(14, 28, 0, 0.005, -12); // o'rta qismdagi pol o'lchami va position





// Binoning tom ustiga oynali qavat yaratish
const glassMaterial1 = new THREE.MeshLambertMaterial({ color: 0x555555, transparent: true, opacity: 0.6 });  // Yarim shaffof oynali material
const glassGeometry1 = new THREE.BoxGeometry(26, 1.5, 6.5);  

const glassFloor1 = new THREE.Mesh(glassGeometry1, glassMaterial1);
glassFloor1.position.set(0, 12.5, 10);  
scene.add(glassFloor1);



// Binoning kirish qismi yaratish
const glassMaterial2 = new THREE.MeshLambertMaterial({ color: 0x111111, transparent: true, opacity: 0.8 });  // Yarim shaffof oynali material
const glassGeometry2 = new THREE.BoxGeometry(6, 2.8, 2); 

const glassFloor2 = new THREE.Mesh(glassGeometry2, glassMaterial2);
glassFloor2.position.set(0, 1, 14.5);  
scene.add(glassFloor2);




// Eshiklar uchun tekstura yuklash
const doorTexture = new THREE.TextureLoader().load('./images/blackdoor.jpg'); // Tekstura faylining yo'lini kiriting

// Tekstura uchun material yaratish (ikki eshikda ham bir xil bo'ladi)
const doorMaterial = new THREE.MeshBasicMaterial({ 
    map: doorTexture, 
    transparent: true, 
    opacity: 0.9 // Tekstura biroz shaffof bo'lsa, opacity ni moslashtirish mumkin
});

// Qora kirish chap eshik yaratish 
const doorGeometry = new THREE.BoxGeometry(1, 1.6, 0.06); // Eshik o'lchamlari
const door = new THREE.Mesh(doorGeometry, doorMaterial); // Eshikni bir xil tekstura bilan yaratish
door.position.set(-2, 0.8, 15.5); // Chap eshik joylashuvi
scene.add(door); // Sahnaga qo'shish

// Qora kirish o'ng eshik yaratish 
const doorGeometry1 = new THREE.BoxGeometry(1, 1.6, 0.06); // Eshik o'lchamlari
const door1 = new THREE.Mesh(doorGeometry1, doorMaterial); // Bir xil tekstura bilan o'ng eshik
door1.position.set(2, 0.8, 15.5); // O'ng eshik joylashuvi
scene.add(door1); // Sahnaga qo'shish




// Binoning o'rtadagi oynalik qismi yaratish
const glassMaterial3 = new THREE.MeshLambertMaterial({ color: 0x111111, transparent: true, opacity: 0.8 });  // Yarim shaffof oynali material
const glassGeometry3 = new THREE.BoxGeometry(12, 12, 4.5); 

const glassFloor3 = new THREE.Mesh(glassGeometry3, glassMaterial3);
glassFloor3.position.set(0, 6, 4.3);  
scene.add(glassFloor3);




// Binoga qo'shimcha qavatlar qo'shish (agar kerak bo'lsa)
const windowMaterial = new THREE.MeshLambertMaterial({ color: 0x444444 });
const windowGeometry = new THREE.BoxGeometry(0.5, 1.7, 0.05);

// Oynalar bino markazidan balandlikka mos keladigan qilib qo'shildi
for (let x = -13; x <= 14; x += 1.3) {
    for (let y = -3; y <= 3; y += 3) {
        const window = new THREE.Mesh(windowGeometry, windowMaterial);
        window.position.set(x, y, 4); // Oynalarni old tomonga joylashtirish
        building.add(window);
    }
}

// Binoning ikki yon tomoniga ham oynalar qo'shish
for (let z = -3.5; z <= 3.5; z += 1.5) {
    for (let y = -3; y <= 3; y += 3) {
        // Chap tomonga oynalar
        const sideWindow1 = new THREE.Mesh(windowGeometry, windowMaterial);
        sideWindow1.position.set(-14, y, z + 0.5); // Chap tomonga oynalarni joylashtirish
        sideWindow1.rotation.y = Math.PI / 2; // Oynalarni yon tomonga burish
        building.add(sideWindow1);

        // O'ng tomonga oynalar
        const sideWindow2 = new THREE.Mesh(windowGeometry, windowMaterial);
        sideWindow2.position.set(14, y, z + 0.5); // O'ng tomonga oynalarni joylashtirish
        sideWindow2.rotation.y = -Math.PI / 2; // Oynalarni yon tomonga burish
        building.add(sideWindow2);
    }
}

//----------------------------------- new -------------------------------------------------------------


// Kompyuter stoli va stul yaratish
function createComputerDesk(x, z) {
    // Kompyuter stoli
    const deskGeometry = new THREE.BoxGeometry(0.75, 0.05, 0.4); // Hajmi ikki barobarga kichraytirildi
    const deskMaterial = new THREE.MeshLambertMaterial({ color: 0x5D4037 });
    const desk = new THREE.Mesh(deskGeometry, deskMaterial);

    // Stul (birinchi stul)
    const chairGeometry = new THREE.BoxGeometry(0.25, 0.05, 0.25); 
    const chairMaterial = new THREE.MeshLambertMaterial({ color: 0x2F4F4F });
    const chair1 = new THREE.Mesh(chairGeometry, chairMaterial);

    const chairBackGeometry = new THREE.BoxGeometry(0.25, 0.3, 0.05); // Orqa suyanish qismi kichraytirildi
    const chairBack1 = new THREE.Mesh(chairBackGeometry, chairMaterial);
    chairBack1.position.set(0, 0.175, -0.1); // Orqa suyanish pozitsiyasi moslashtirildi
    chair1.add(chairBack1);

    // Stol uchun oyoqchalar yaratish
    const legGeometry = new THREE.CylinderGeometry(0.025, 0.025, 0.4); 
    const legMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });
    const leg1 = new THREE.Mesh(legGeometry, legMaterial);
    const leg2 = new THREE.Mesh(legGeometry, legMaterial);
    const leg3 = new THREE.Mesh(legGeometry, legMaterial);
    const leg4 = new THREE.Mesh(legGeometry, legMaterial);

    leg1.position.set(-0.35, -0.2, -0.17); // Stol oyoqlarining pozitsiyalari moslashtirildi
    leg2.position.set(0.35, -0.2, -0.17);
    leg3.position.set(-0.35, -0.2, 0.17);
    leg4.position.set(0.35, -0.2, 0.17);

    desk.add(leg1, leg2, leg3, leg4); // Stol oyoqlarini stolga qo'shish

    // Stul uchun oyoqchalar yaratish (birinchi stul)
    const chairLegGeometry = new THREE.CylinderGeometry(0.015, 0.015, 0.25); 
    const chairLegMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });
    const chairLeg1 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg2 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg3 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg4 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);

    chairLeg1.position.set(-0.1, -0.125, -0.1); // Stul oyoqlarining pozitsiyalari moslashtirildi
    chairLeg2.position.set(0.1, -0.125, -0.1);
    chairLeg3.position.set(-0.1, -0.125, 0.1);
    chairLeg4.position.set(0.1, -0.125, 0.1);

    chair1.add(chairLeg1, chairLeg2, chairLeg3, chairLeg4); // Birinchi stul oyoqlarini stulga qo'shish

    // Ikkinchi stulni yaratish
    const chair2 = new THREE.Mesh(chairGeometry, chairMaterial);
    const chairBack2 = new THREE.Mesh(chairBackGeometry, chairMaterial);
    chairBack2.position.set(0, 0.175, -0.1); // Ikkinchi stul uchun orqa suyanish pozitsiyasi
    chair2.add(chairBack2);

    // Ikkinchi stul oyoqlarini yaratish
    const chairLeg5 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg6 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg7 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
    const chairLeg8 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);

    chairLeg5.position.set(-0.1, -0.125, -0.1);
    chairLeg6.position.set(0.1, -0.125, -0.1);
    chairLeg7.position.set(-0.1, -0.125, 0.1);
    chairLeg8.position.set(0.1, -0.125, 0.1);

    chair2.add(chairLeg5, chairLeg6, chairLeg7, chairLeg8); // Ikkinchi stul oyoqlarini stulga qo'shish

    // Stol va stullarni joylashtirish va y o'qida biroz ko'tarish
    chair1.position.set(x - 0.3, 0.25, z); // Birinchi stulning pozitsiyasi
    chair2.position.set(x + 0.3, 0.25, z); // Ikkinchi stulning pozitsiyasi
    desk.position.set(x, 0.35, z); // Stolning y pozitsiyasi bir xil qoladi

    // 90 gradusga burish (y o'qi bo'yicha)
    chair1.rotation.y = Math.PI / 2; // Birinchi stulni 90 gradusga burish
    chair2.rotation.y = -Math.PI / 2; // Ikkinchi stulni 90 gradusga qarshi burish
    desk.rotation.y = Math.PI / 2;  // Stolni 90 gradusga burish

    // Sahnaga qo'shish
    scene.add(desk, chair1, chair2);
}





  // Jamoaviy stol va stullar
  function createMeetingTable(x, z) {
    // Stolni yaratish
    const tableGeometry = new THREE.BoxGeometry(1.5, 0.05, 0.75); 
    const tableMaterial = new THREE.MeshLambertMaterial({ color: 0xe9e9e9 });
    const table = new THREE.Mesh(tableGeometry, tableMaterial);

    // Stol oyoqlari
    const legGeometry = new THREE.CylinderGeometry(0.02, 0.02, 0.5); 
    const legMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });

    const leg1 = new THREE.Mesh(legGeometry, legMaterial);
    const leg2 = new THREE.Mesh(legGeometry, legMaterial);
    const leg3 = new THREE.Mesh(legGeometry, legMaterial);
    const leg4 = new THREE.Mesh(legGeometry, legMaterial);

    // Stol oyoqlarini biroz pastga tushirish
    leg1.position.set(-0.7, -0.24, -0.35); // Y pozitsiyani biroz pasaytirish
    leg2.position.set(0.7, -0.24, -0.35);
    leg3.position.set(-0.7, -0.24, 0.35);
    leg4.position.set(0.7, -0.24, 0.35);

    table.add(leg1, leg2, leg3, leg4); 

    table.rotation.y = Math.PI / 2;

    // To'siq yaratish va pozitsiyasini pasaytirish
    const dividerGeometry = new THREE.BoxGeometry(0.03, 0.15, 1.5);
    const dividerMaterial = new THREE.MeshLambertMaterial({ color: 0x818181 });
    const divider = new THREE.Mesh(dividerGeometry, dividerMaterial);
    divider.rotation.y = Math.PI / 2;
    divider.position.set(0, 0.1, 0); // Y pozitsiyani pasaytirish
    table.add(divider);

    // Lampalar joylashuvi ham y-pozitsiyasini pasaytirish
    function addLampToDivider(xOffset) {
        const lampGeometry = new THREE.CylinderGeometry(0.02, 0.02, 1.3);
        const lampMaterial = new THREE.MeshBasicMaterial({ color: 0xFFFF99 });
        const lamp = new THREE.Mesh(lampGeometry, lampMaterial);
        lamp.position.set(0, 0.04, 0); // Y pozitsiyani biroz pasaytirish
        lamp.rotation.z = Math.PI / 2;
        lamp.rotation.y = Math.PI / 2;
        divider.add(lamp);
    }

    addLampToDivider(0.75);
    addLampToDivider(-0.75);

    // Stullar (y-pozitsiyasini pasaytirish)
    const chairGeometry = new THREE.BoxGeometry(0.25, 0.05, 0.25);
    const chairMaterial = new THREE.MeshLambertMaterial({ color: 0x3a633f });
    const chairBackGeometry = new THREE.BoxGeometry(0.25, 0.3, 0.05);
    const chairLegGeometry = new THREE.CylinderGeometry(0.02, 0.02, 0.3);
    const chairLegMaterial = new THREE.MeshLambertMaterial({ color: 0x4b5f35 });

    for (let i = -1; i <= 1; i++) {
        const chairLeft = new THREE.Mesh(chairGeometry, chairMaterial);
        const chairBackLeft = new THREE.Mesh(chairBackGeometry, chairMaterial);
        chairLeft.add(chairBackLeft);
        chairBackLeft.position.set(0, 0.175, -0.1);
        chairLeft.position.set(x + 0.6, 0.2, z + i * 0.6); // Y pozitsiyasini pasaytirish (masalan, 0.3 -> 0.2)
        chairLeft.rotation.y = Math.PI / -2;

        const chairLeg1 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg2 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg3 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg4 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);

        chairLeg1.position.set(-0.1, -0.15, -0.1);
        chairLeg2.position.set(0.1, -0.15, -0.1);
        chairLeg3.position.set(-0.1, -0.15, 0.1);
        chairLeg4.position.set(0.1, -0.15, 0.1);

        chairLeft.add(chairLeg1, chairLeg2, chairLeg3, chairLeg4);
        scene.add(chairLeft);

        const chairRight = new THREE.Mesh(chairGeometry, chairMaterial);
        const chairBackRight = new THREE.Mesh(chairBackGeometry, chairMaterial);
        chairRight.add(chairBackRight);
        chairBackRight.position.set(0, 0.175, -0.1);
        chairRight.position.set(x - 0.6, 0.2, z + i * 0.6); // Y pozitsiyasini pasaytirish
        chairRight.rotation.y = Math.PI / 2;

        const chairLeg5 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg6 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg7 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);
        const chairLeg8 = new THREE.Mesh(chairLegGeometry, chairLegMaterial);

        chairLeg5.position.set(-0.1, -0.15, -0.1);
        chairLeg6.position.set(0.1, -0.15, -0.1);
        chairLeg7.position.set(-0.1, -0.15, 0.1);
        chairLeg8.position.set(0.1, -0.15, 0.1);

        chairRight.add(chairLeg5, chairLeg6, chairLeg7, chairLeg8);
        scene.add(chairRight);
    }

    table.position.set(x, 0.3, z); 
    scene.add(table);
}



// Xona yaratish
function createRoom(x, z, width, height, depth) {
    // Qolgan uchta devor (bitta blok sifatida)
    const roomGeometry = new THREE.BoxGeometry(width, height, depth);
    const roomMaterial = new THREE.MeshLambertMaterial({ color: 0xCCCCCC, side: THREE.DoubleSide });
    const room = new THREE.Mesh(roomGeometry, roomMaterial);

    room.position.set(x, height / 2 - 0.2, z); // Xonaning joylashuvi
    scene.add(room);

    // Old devor uchun (esiksiz)
    const frontWallGeometry = new THREE.PlaneGeometry(width, height); // Old devor uchun Plane
    const doorTexture = new THREE.TextureLoader().load('./images/newDoor.jpg'); // Eshik uchun tekstura

    // Tekstura takrorlanishi uchun o'rnatish
    doorTexture.wrapS = THREE.RepeatWrapping;
    doorTexture.wrapT = THREE.RepeatWrapping;
    doorTexture.repeat.set(5, 1); // X o'qida 3 marta takrorlanadi, Y o'qida 1 marta

    const frontWallMaterial = new THREE.MeshLambertMaterial({ map: doorTexture, side: THREE.DoubleSide });

    const frontWall = new THREE.Mesh(frontWallGeometry, frontWallMaterial);
    frontWall.position.set(x, height / 2 - 0.2, z + depth / 2 + 0.001); // Old devorni joylashtirish
    frontWall.rotation.y = Math.PI; // To'g'ri holatda ko'rinish uchun aylantirish

    scene.add(frontWall); // Sahnaga qo'shish
}



    // Tualet eshigi chap
    const doorGeometryToilet = new THREE.BoxGeometry(0.5, 2, 0.05);
    const doorMaterialToilet = new THREE.MeshBasicMaterial({ color: 0xdbdbdb});
    const doorToilet = new THREE.Mesh(doorGeometryToilet, doorMaterialToilet);
    doorToilet.rotation.y = Math.PI / 2; // To'g'ri holatda ko'rinish uchun aylantirish
    doorToilet.position.set(-2.9, 0.5, 8.5); // Qora doska joylashuvi
    scene.add(doorToilet);



    // Lift eshigi (tekstura bilan)
    const doorGeometryElevator = new THREE.BoxGeometry(1.5, 2, 0.05); // Eshik geometriyasi

    // Tekstura yuklash
    const doorTextureElevator = new THREE.TextureLoader().load('./images/elevator.jpg'); // Tekstura faylini yuklash
    const doorMaterialElevator = new THREE.MeshBasicMaterial({ map: doorTextureElevator }); // Tekstura bilan material yaratish

    const doorElevator = new THREE.Mesh(doorGeometryElevator, doorMaterialElevator);
    doorElevator.rotation.y = Math.PI / 2; // To'g'ri holatda ko'rinish uchun aylantirish
    doorElevator.position.set(3, 0.5, 8); // Lift eshigi pozitsiyasi
    scene.add(doorElevator); // Eshikni sahnaga qo'shish


    // Kompyuterlar uchun stollar qo'shish
    createComputerDesk(-5.2, 3);
    createComputerDesk(-5.2, 4.5);
    createComputerDesk(-4, 3);
    createComputerDesk(-2.8, 3);


    // O'ng tomon jamoaviy ish uchun stol va stullar
    createMeetingTable(11.5, 12);
    createMeetingTable(9, 12);
    createMeetingTable(6.5, 12);
    createMeetingTable(11.5, 8); // xona ichidagi
    createMeetingTable(9, 8); // xona ichidagi
    createMeetingTable(6.5, 8); // xona ichidagi


    // Chap tomon jamoaviy ish uchun stol va stullar
    createMeetingTable(-11.5, 12);
    createMeetingTable(-9, 12);
    createMeetingTable(-6.5, 12);
    createMeetingTable(-11.5, 8); // xona ichidagi
    createMeetingTable(-9, 8); // xona ichidagi
    createMeetingTable(-6.5, 8); // xona ichidagi

    // Alohida xona qo'shish
    createRoom(-7.99, 7.9, 10, 2.69, 2.6);
    createRoom(7.99, 7.9, 10, 2.69, 2.6);


  // Quyosh paneli yaratish (tekstura bilan)
  function createSolarPanel(x, y, z) {
    // Tekstura yuklash
    const panelTexture = new THREE.TextureLoader().load('./images/solarPanel.jpg'); // Quyosh paneli teksturasi faylining yo'lini kiriting
   
    panelTexture.wrapS = THREE.RepeatWrapping;
    panelTexture.wrapT = THREE.RepeatWrapping;
    panelTexture.repeat.set(10, 10); // Takrorlanish miqdori (moslashtirish mumkin)
    
    
    
    // Quyosh paneli geometriyasi va materiallari
    const panelGeometry = new THREE.PlaneGeometry(6, 20); // Kichraytirilgan quyosh paneli o'lchami (10x10)
    const panelMaterial = new THREE.MeshBasicMaterial({ 
        map: panelTexture,   // Tekstura qo'shish
        side: THREE.DoubleSide // Tekstura ikkala tomondan ham ko'rinadi
    });

    // Quyosh paneli yaratish
    const solarPanel = new THREE.Mesh(panelGeometry, panelMaterial);

    // Panelni yerga yotqizish (Parallel)
    solarPanel.rotation.y = -Math.PI / -1.05; // X o'qi bo'ylab 90 gradus aylantirish (yotqizish uchun)

    solarPanel.rotation.x = -Math.PI / 2; // X o'qi bo'ylab 90 gradus aylantirish (yotqizish uchun)
    
    // Panelni tom ustiga joylashtirish
    solarPanel.position.set(x, y, z); // X, Y, Z pozitsiyalarini moslang

    // Quyosh panelini sahnaga qo'shish
    scene.add(solarPanel);
}

// Quyosh panelini binoning tomiga qo'yish
createSolarPanel(-3.5, 12.5, -14); // Binoning tomida (koordinatalarni moslashtiring)



// Murakkab aloqa antenasini yaratish
function createComplexCommunicationAntenna(x, y, z) {
    // 1. Antena uchun vertikal ustun (silindr shakli)
    const antennaPoleGeometry = new THREE.CylinderGeometry(0.1, 0.1, 5, 32); // Antena ustuni (kichraytirilgan)
    const antennaPoleMaterial = new THREE.MeshBasicMaterial({ color: 0x444444 }); // Antena materiali (kulrang)
    const antennaPole = new THREE.Mesh(antennaPoleGeometry, antennaPoleMaterial);

    // 2. Disk shaklidagi aloqa qismi (aloqa uchun "dish" shakli)
    const dishGeometry = new THREE.CylinderGeometry(1, 0.15, 0.3, 32); // "Dish" shakli (kichraytirilgan)
    const dishMaterial = new THREE.MeshBasicMaterial({ color: 0x888888 }); // Materiali
    const dish = new THREE.Mesh(dishGeometry, dishMaterial);

    // 3. Halqa shaklidagi aloqa qismlari
    const ringGeometry = new THREE.TorusGeometry(1.2, 0.05, 16, 100); // Kichraytirilgan halqa shakli
    const ringMaterial = new THREE.MeshBasicMaterial({ color: 0xaaaaaa }); // Halqa materiali (kulrang)
    const ring1 = new THREE.Mesh(ringGeometry, ringMaterial);
    const ring2 = new THREE.Mesh(ringGeometry, ringMaterial);
    const ring3 = new THREE.Mesh(ringGeometry, ringMaterial); // Qo'shimcha halqa

    // 4. Ustun tepasiga kichik sfera (yuqori qismdagi aloqa elementi)
    const topSphereGeometry = new THREE.SphereGeometry(0.2, 32, 32); // Kichraytirilgan sfera
    const topSphereMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 }); // Qizil rangli yuqori qism
    const topSphere = new THREE.Mesh(topSphereGeometry, topSphereMaterial);

    // 5. Simlar (cables) uchun geometriya va material
    const cableGeometry = new THREE.CylinderGeometry(0.02, 0.02, 3, 32); // Kichik simlar
    const cableMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Qora simlar

    const cable1 = new THREE.Mesh(cableGeometry, cableMaterial);
    const cable2 = new THREE.Mesh(cableGeometry, cableMaterial);
    const cable3 = new THREE.Mesh(cableGeometry, cableMaterial);

    // Pozitsiyalarni o'rnatish
    antennaPole.position.set(x, y + 2.5, z); // Vertikal ustun (biroz kichraytirilgan)
    dish.position.set(x, y + 1.5, z + 1); // "Dish" oldinga qarab joylashadi (kichraytirilgan)
    dish.rotation.x = Math.PI / 4; // "Dish" biroz yuqoriga qaratilgan

    ring1.position.set(x, y + 2.5, z); // Birinchi halqa (tepada)
    ring1.rotation.x = Math.PI / 2; // Vertikal holatda
    ring2.position.set(x, y + 3.5, z); // Ikkinchi halqa (yana yuqoriroqda)
    ring2.rotation.x = Math.PI / 2; // Vertikal holatda
    ring3.position.set(x, y + 4.5, z); // Uchinchisi yuqorida joylashgan
    ring3.rotation.x = Math.PI / 2; // Vertikal holatda

    topSphere.position.set(x, y + 5, z); // Yuqori qismdagi kichik sfera

    // Simlarni qo'shish (dish va ustun orasida)
    cable1.position.set(x - 0.5, y + 2, z + 1); // Sim 1 pozitsiyasi
    cable1.rotation.z = Math.PI / 2; // Simni aylantirish
    cable2.position.set(x + 0.5, y + 2, z + 1); // Sim 2 pozitsiyasi
    cable2.rotation.z = Math.PI / 2; // Simni aylantirish
    cable3.position.set(x, y + 2.5, z); // Ustun bo'ylab vertikal sim

    // Sahnaga qo'shish
    scene.add(antennaPole);
    scene.add(dish);
    scene.add(ring1);
    scene.add(ring2);
    scene.add(ring3);
    scene.add(topSphere);
    scene.add(cable1);
    scene.add(cable2);
    scene.add(cable3);
}

// Antenani binoning tomiga o'rnatish (kichraytirilgan va murakkab antena)
createComplexCommunicationAntenna(0, 12, -1); // Antena binoning tomida joylashadi






// Konditsioner qurilmasini yaratish
function createAirConditioner(x, y, z) {
    // 1. Konditsioner uchun asosiy qism (katta to'rtburchak quti)
    const baseGeometry = new THREE.BoxGeometry(4, 1.5, 6); // Katta to'rtburchak shakli
    const baseMaterial = new THREE.MeshBasicMaterial({ color: 0xcccccc }); // Oq kulrang rang
    const base = new THREE.Mesh(baseGeometry, baseMaterial);

    // 2. Konditsionerning ventilyatori (dumaloq shakl, o'rtada joylashgan)
    const fanGeometry = new THREE.CylinderGeometry(0.8, 0.8, 0.2, 32); // Ventilyator uchun dumaloq qism
    const fanMaterial = new THREE.MeshBasicMaterial({ color: 0x333333 }); // Qora ventilyator materiali
    const fan = new THREE.Mesh(fanGeometry, fanMaterial);

    // 3. Ventilyator pichoqlari
    const bladeGeometry = new THREE.BoxGeometry(0.05, 0.05, 1); // Pichoqlar uchun ingichka qism
    const bladeMaterial = new THREE.MeshBasicMaterial({ color: 0x666666 }); // Pichoqlar uchun material
    const blade1 = new THREE.Mesh(bladeGeometry, bladeMaterial);
    const blade2 = new THREE.Mesh(bladeGeometry, bladeMaterial);

    // Pichoqlarni o'zaro perpendikulyar qilish (x o'qida burish)
    blade1.rotation.x = Math.PI / 2; // Pichoqlarni perpendikulyar holatga keltirish
    blade2.rotation.x = 0; // Yana bitta perpendikulyar

    // Pichoqlarni ventilyatorning markaziga joylashtirish
    fan.add(blade1);
    fan.add(blade2);

    // Pozitsiyalarni o'rnatish
    base.position.set(x, y + 1, z); // Asosiy konditsioner qismi (katta to'rtburchak)
    fan.position.set(x, y + 1.8, z); // Ventilyator konditsionerning ustiga o'rnatiladi

    // Sahnaga qo'shish
    scene.add(base);
    scene.add(fan);
}

// Konditsionerni binoning tomiga o'rnatish
createAirConditioner(2, 11.76, -8); // Konditsionerni binoning tomiga joylashtirish
// Konditsionerni binoning tomiga o'rnatish
createAirConditioner(2, 11.76, -16); // Konditsionerni binoning tomiga joylashtirish





// O't teksturasini yuklash
const customGrassTexture = new THREE.TextureLoader().load('./images/gardenn.png'); // O't teksturasi yo'li

// Tekstura takrorlanishini o'rnatish
customGrassTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
customGrassTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
customGrassTexture.repeat.set(2, 3); // 2 marta gorizontal va 1 marta vertikal takrorlash

// O't ob'ekti yaratish (border-radius effekti bilan)
function createCustomRoundedGrass(x, y, z) {
    // Shape yaratish
    const customGrassShape = new THREE.Shape();
    
    // Boshlanish nuqtasi (pastki chap burchak)
    customGrassShape.moveTo(-5, -1); 

    // Yuqori chap qayriq burchak
    customGrassShape.quadraticCurveTo(-5, 1, -4, 1); 

    // Yuqori tekis qismi
    customGrassShape.lineTo(4, 1); 

    // Yuqori o'ng qayriq burchak
    customGrassShape.quadraticCurveTo(5, 1, 5, -1); 

    // Pastki o'ng qismi
    customGrassShape.lineTo(5, -1); 

    // Pastki qismni yopish
    customGrassShape.lineTo(-5, -1);

    // Geometriya yaratish (Shape)
    const customGrassGeometry = new THREE.ShapeGeometry(customGrassShape);

    // Tekstura bilan material yaratish
    const customGrassMaterial = new THREE.MeshBasicMaterial({ map: customGrassTexture });

    // O't ob'ekti (mesh) yaratish
    const customGrassMesh = new THREE.Mesh(customGrassGeometry, customGrassMaterial);

    // Pozitsiyani o'rnatish
    customGrassMesh.position.set(x, y, z);

    // O't ob'ektini yerga parallel qilib aylantirish (X o'qida 90 daraja)
    customGrassMesh.rotation.x = -Math.PI / 2;
    customGrassMesh.rotation.z = Math.PI / -2;

    // O'lchamni X o'qi bo'yicha kattalashtirish (faqat X o'qi bo'yicha)
    customGrassMesh.scale.set(1.1, 2, 1); // X o'qi bo'yicha 1.5 marta kattalashtirish

    // O'tni sahnaga qo'shish
    scene.add(customGrassMesh);
}

// O't ob'ektini yaratish va sahnaga qo'shish
createCustomRoundedGrass(9, 0.03, -3.5); // Ob'ektni kerakli joyga joylashtirish
createCustomRoundedGrass(9, 0.03, -20.5); // Ob'ektni kerakli joyga joylashtirish




// Yangi o't teksturasini yuklash
const secondaryGrassTexture = new THREE.TextureLoader().load('./images/gardenn.png'); // Ikkinchi o't teksturasi yo'li

// Tekstura takrorlanishini o'rnatish
secondaryGrassTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
secondaryGrassTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
secondaryGrassTexture.repeat.set(1, 1); // 3 marta gorizontal va 2 marta vertikal takrorlash

// Yangi yon old o't ob'ekti yaratish (border-radius effekti bilan)
function createSecondaryRoundedGrass(x, y, z) {
    // Yangi Shape yaratish
    const secondaryGrassShape = new THREE.Shape();
    
    // Boshlanish nuqtasi (pastki chap burchak)
    secondaryGrassShape.moveTo(-5, -1); 

    // Yuqori chap qayriq burchak
    secondaryGrassShape.quadraticCurveTo(-5, 1, -4, 1); 

    // Yuqori tekis qismi
    secondaryGrassShape.lineTo(4, 1); 

    // Yuqori o'ng qayriq burchak
    secondaryGrassShape.quadraticCurveTo(5, 1, 5, -1); 

    // Pastki o'ng qismi
    secondaryGrassShape.lineTo(5, -1); 

    // Pastki qismni yopish
    secondaryGrassShape.lineTo(-5, -1);

    // Yangi geometriya yaratish (Shape)
    const secondaryGrassGeometry = new THREE.ShapeGeometry(secondaryGrassShape);

    // Yangi tekstura bilan material yaratish
    const secondaryGrassMaterial = new THREE.MeshBasicMaterial({ map: secondaryGrassTexture });

    // O't ob'ekti (mesh) yaratish
    const secondaryGrassMesh = new THREE.Mesh(secondaryGrassGeometry, secondaryGrassMaterial);

    // Pozitsiyani o'rnatish
    secondaryGrassMesh.position.set(x, y, z);

    // O't ob'ektini yerga parallel qilib aylantirish (X o'qida 90 daraja)
    secondaryGrassMesh.rotation.x = -Math.PI / 2;
    secondaryGrassMesh.rotation.z = Math.PI / 2;

    // O'lchamni X o'qi bo'yicha kattalashtirish (faqat X o'qi bo'yicha)
    secondaryGrassMesh.scale.set(0.8, 1.5, 1); // X o'qi bo'yicha 1.2 marta kattalashtirish

    // Yangi o'tni sahnaga qo'shish
    scene.add(secondaryGrassMesh);
}

// Yangi o't ob'ektini yaratish va sahnaga qo'shish
createSecondaryRoundedGrass(-9, 0.05, -23); // Ob'ektni kerakli joyga joylashtirish
createSecondaryRoundedGrass(-15.5, 0.035, 11); // Ob'ektni kerakli joyga joylashtirish
createSecondaryRoundedGrass(15.5, 0.035, 11); // Ob'ektni kerakli joyga joylashtirish







// To'g'ri uchburchak uchun o't teksturasini yuklash
const sharpTriangleGrassTexture = new THREE.TextureLoader().load('./images/gardenn.png'); // To'g'ri uchburchak o't teksturasi yo'li

// Tekstura takrorlanishini o'rnatish
sharpTriangleGrassTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
sharpTriangleGrassTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
sharpTriangleGrassTexture.repeat.set(2, 2); // 2 marta gorizontal va 2 marta vertikal takrorlash

// To'g'ri uchburchak shaklidagi o't ob'ektini yaratish
function createSharpTriangleGrass(x, y, z) {
    // To'g'ri uchburchak Shape yaratish
    const sharpTriangleShape = new THREE.Shape();
    
    // Uchburchakning uchlari
    sharpTriangleShape.moveTo(0, 0);  // Pastki chap burchak (0, 0)
    sharpTriangleShape.lineTo(15, 0);  // O'ng pastki burchak (to'g'ri chiziq)
    sharpTriangleShape.lineTo(0, 6.1);  // Yuqori uch (to'g'ri burchaklik shakl)
    sharpTriangleShape.lineTo(0, 0);  // Shaklni yopish

    // Geometriya yaratish (Shape)
    const sharpTriangleGeometry = new THREE.ShapeGeometry(sharpTriangleShape);

    // Tekstura bilan material yaratish
    const sharpTriangleMaterial = new THREE.MeshBasicMaterial({ map: sharpTriangleGrassTexture });

    // O't ob'ekti (mesh) yaratish
    const sharpTriangleMesh = new THREE.Mesh(sharpTriangleGeometry, sharpTriangleMaterial);

    // Pozitsiyani o'rnatish
    sharpTriangleMesh.position.set(x, y, z);

    // O't ob'ektini yerga parallel qilib aylantirish (X o'qida 90 daraja)
    sharpTriangleMesh.rotation.x = -Math.PI / 2;
    sharpTriangleMesh.rotation.z = Math.PI / 2;


    // O'lchamni sozlash (agar kerak bo'lsa)
    sharpTriangleMesh.scale.set(1, 1, 1);

    // O'tni sahnaga qo'shish
    scene.add(sharpTriangleMesh);
}

// To'g'ri uchburchak shaklidagi o't ob'ektini yaratish va sahnaga qo'shish
createSharpTriangleGrass(-7, 0.05, 6.6); // Ob'ektni kerakli joyga joylashtirish




// Tuxumsimon shakldagi o't teksturasini yuklash
const ovalGrassTexture = new THREE.TextureLoader().load('./images/gardenn.png'); // Tuxumsimon o't teksturasi yo'li

// Tekstura takrorlanishini o'rnatish
ovalGrassTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
ovalGrassTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
ovalGrassTexture.repeat.set(1, 1);

// Tuxumsimon shakldagi o't ob'ekti yaratish
function createOvalGrass(x, y, z) {
    // Tuxumsimon Shape yaratish
    const ovalGrassShape = new THREE.Shape();
    
    // Ellips shakli (tuxumsimon)
    ovalGrassShape.absellipse(0, 0, 7, 3, 0, Math.PI * 2, false);  // (X markaz, Y markaz, X radius, Y radius, boshlanish burchagi, yakun burchagi)

    // Geometriya yaratish (Shape)
    const ovalGrassGeometry = new THREE.ShapeGeometry(ovalGrassShape);

    // Tekstura bilan material yaratish
    const ovalGrassMaterial = new THREE.MeshBasicMaterial({ map: ovalGrassTexture });

    // O't ob'ekti (mesh) yaratish
    const ovalGrassMesh = new THREE.Mesh(ovalGrassGeometry, ovalGrassMaterial);

    // Pozitsiyani o'rnatish
    ovalGrassMesh.position.set(x, y, z);

    // O't ob'ektini yerga parallel qilib aylantirish (X o'qida 90 daraja)
    ovalGrassMesh.rotation.x = -Math.PI / 2;
    ovalGrassMesh.rotation.z = -Math.PI / 2;

    // O'lchamni sozlash (agar kerak bo'lsa)
    ovalGrassMesh.scale.set(1, 1, 1);

    // O'tni sahnaga qo'shish
    scene.add(ovalGrassMesh);
}

// Tuxumsimon o't ob'ektini yaratish va sahnaga qo'shish
createOvalGrass(-18, 0.05, -8); // Ob'ektni kerakli joyga joylashtirish
createOvalGrass(18, 0.05, -6); // Ob'ektni kerakli joyga joylashtirish
createOvalGrass(18, 0.05, -22); // Ob'ektni kerakli joyga joylashtirish





// Old taraf o't ob'ekti yaratish (border-radius effekti bilan)
function createShortenedGrass(x, y, z) {
    // Yangi Shape yaratish
    const shortenedGrassShape = new THREE.Shape();
    
    // Boshlanish nuqtasi (pastki chap burchak)
    shortenedGrassShape.moveTo(-4, -1); 

    // Yuqori chap qayriq burchak
    shortenedGrassShape.quadraticCurveTo(-4, 1, -3, 1); 

    // Yuqori tekis qismi
    shortenedGrassShape.lineTo(3, 1); 

    // Yuqori o'ng qayriq burchak
    shortenedGrassShape.quadraticCurveTo(4, 1, 4, -1); 

    // Pastki o'ng qismi
    shortenedGrassShape.lineTo(4, -1); 

    // Pastki qismni yopish
    shortenedGrassShape.lineTo(-4, -1);

    // Yangi geometriya yaratish (Shape)
    const shortenedGrassGeometry = new THREE.ShapeGeometry(shortenedGrassShape);

    // Yangi tekstura bilan material yaratish
    const shortenedGrassMaterial = new THREE.MeshBasicMaterial({ map: secondaryGrassTexture });

    // O't ob'ekti (mesh) yaratish
    const shortenedGrassMesh = new THREE.Mesh(shortenedGrassGeometry, shortenedGrassMaterial);

    // Pozitsiyani o'rnatish
    shortenedGrassMesh.position.set(x, y, z);

    // O't ob'ektini yerga parallel qilib aylantirish (X o'qida 90 daraja)
    shortenedGrassMesh.rotation.x = -Math.PI / 2;
    shortenedGrassMesh.rotation.z = -Math.PI / 1;

    // O'lchamni X o'qi bo'yicha kattalashtirish (faqat X o'qi bo'yicha)
    shortenedGrassMesh.scale.set(1.6, 2, 1); // X o'qi bo'yicha 1.2 marta kattalashtirish

    // Yangi o'tni sahnaga qo'shish
    scene.add(shortenedGrassMesh);
}

// Yangi o't ob'ektini yaratish va sahnaga qo'shish
createShortenedGrass(-10.5, 0.05, 16.5); // Ob'ektni kerakli joyga joylashtirish
createShortenedGrass(10.5, 0.05, 16.5); // Ob'ektni kerakli joyga joylashtirish




// Parking teksturasini yuklash
const parkingTexture = new THREE.TextureLoader().load('./images/parkingNew.jpg'); // Parking uchun tekstura yo'li

// Tekstura takrorlanishini sozlash
parkingTexture.wrapS = THREE.RepeatWrapping; // Gorizontal takrorlash
parkingTexture.wrapT = THREE.RepeatWrapping; // Vertikal takrorlash
parkingTexture.repeat.set(1, 1); // Teksturaning takrorlanish miqdorini sozlash (gorizontal va vertikal)


// Parking yaratish funksiyasi
function createParkingArea(x, y, z, width, height) {
    // Geometriya yaratish (parking maydoni uchun)
    const parkingGeometry = new THREE.PlaneGeometry(width, height);

    // Material yaratish (tekstura bilan)
    const parkingMaterial = new THREE.MeshBasicMaterial({ map: parkingTexture });

    // Mesh yaratish
    const parkingMesh = new THREE.Mesh(parkingGeometry, parkingMaterial);

    // Pozitsiyani o'rnatish
    parkingMesh.position.set(x, y, z);

    // Parkingni yerga parallel qilib aylantirish (X o'qida 90 daraja)
    parkingMesh.rotation.x = -Math.PI / 2;
    parkingMesh.rotation.z = -Math.PI / 2;

    // Parkingni sahnaga qo'shish
    scene.add(parkingMesh);
}

// Parking yaratish va sahnaga qo'shish
createParkingArea(-20.5, 0.05, -30, 12, 8); // 20x30 o'lchamdagi parkingni joylashtirish








// Lampochkali kichik ustuncha yaratish funksiyasi
function createLampPost(x, y, z) {
    // Ustun (silindr shakli)
    const postGeometry = new THREE.CylinderGeometry(0.05, 0.05, 1); // Kichik ustuncha
    const postMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 }); // Qoraroq material
    const post = new THREE.Mesh(postGeometry, postMaterial);
    post.position.set(x, y + 0.5, z); // Ustuncha yerga qo'yilgan va 1 birlikka ko'tarilgan

    // Lampochka (kichik sfera shakli)
    const bulbGeometry = new THREE.SphereGeometry(0.1, 16, 16); // Kichik lampochka
    const bulbMaterial = new THREE.MeshStandardMaterial({ color: 0xffffe0, emissive: 0xffffe0, emissiveIntensity: 0.8 }); // Yorug'lik effekti bilan sariq lampochka
    const bulb = new THREE.Mesh(bulbGeometry, bulbMaterial);
    bulb.position.set(x, y + 1.05, z); // Lampochkani ustunning yuqorisiga qo'yish

    // Yorug'lik qo'shish (ambientlight yoki pointlight bilan)
    const light = new THREE.PointLight(0xffffe0, 1, 5); // Yorug'lik (radius 5 birlik)
    light.position.set(x, y + 1.05, z); // Lampochkaning joyiga o'rnatish

    // Sahnaga qo'shish
    scene.add(post);
    scene.add(bulb);
    scene.add(light);
}

// Lampochkali ustuncha yaratish va sahnaga qo'shish
createLampPost(10, 0.05, -0.2); // o'ng
createLampPost(10, 0.05, -3.2);
createLampPost(10, 0.05, -6.2);

createLampPost(10, 0.05, -17.2); // o'ng
createLampPost(10, 0.05, -20.2);
createLampPost(10, 0.05, -23.2);

createLampPost(18, 0.05, -19.2); // o'ng
createLampPost(18, 0.05, -26.8);

createLampPost(18, 0.05, -10.2); //o'ng
createLampPost(18, 0.05, -2.2);

createLampPost(15.5, 0.05, 10.2); //o'ng
createLampPost(15.5, 0.05, 13.2);
createLampPost(15.5, 0.05, 16.2);
createLampPost(12.5, 0.05, 16.2);
createLampPost(9.5, 0.05, 16.2);
createLampPost(6.5, 0.05, 16.2);

createLampPost(-15.5, 0.05, 10.2); //chap
createLampPost(-15.5, 0.05, 13.2);
createLampPost(-15.5, 0.05, 16.2);
createLampPost(-12.5, 0.05, 16.2);
createLampPost(-9.5, 0.05, 16.2);
createLampPost(-6.5, 0.05, 16.2);

createLampPost(-19.5, 0.05, -6.2); //chap
createLampPost(-18.5, 0.05, -11.2);

createLampPost(-8.5, 0.05, -2.2);
createLampPost(-10, 0.05, 1.2); //chap
createLampPost(-11.2, 0.05, 4.2);

createLampPost(-9.2, 0.05, -20.2); //chap
createLampPost(-9.2, 0.05, -23.2);
createLampPost(-9.2, 0.05, -26.2);

createLampPost(3.2, 0.05, -31.8); //chap
createLampPost( 0.2, 0.05, -31.8);
createLampPost(-3.2, 0.05, -31.8);

createLampPost(-16.5, 0.05, -36); //chap
createLampPost(-16.5, 0.05, -24);
createLampPost(-24.5, 0.05, -36); //chap
createLampPost(-24.5, 0.05, -24);

createLampPost(-5.5, 0.05, 34.5); //old
createLampPost(-18.5, 0.05, 25.5);
createLampPost(-18.5, 0.05, 34.5); 
createLampPost(-5.5, 0.05, 25.5);

createLampPost(5.5, 0.05, 34.5); //old
createLampPost(18.5, 0.05, 25.5);
createLampPost(18.5, 0.05, 34.5); 
createLampPost(5.5, 0.05, 25.5);



// Font yuklash va "Aliboev Abbos 2024.10.25 (CBNU)" yozuvini yaratish
const customFontLoader1 = new THREE.FontLoader();

customFontLoader1.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function (customFont) {
    // Yozuv geometriyasini yaratish
    const customTextGeometry1 = new THREE.TextGeometry('Aliboev Abbos 2024.10.25 (CBNU)', {
        font: customFont,
        size: 0.5,          // Yozuv o'lchami
        height: 0.05,       // Bo'rtma qalinligi
        curveSegments: 12,  // Matn silliqligi uchun segmentlar
        bevelEnabled: true, // Bo'rtma
        bevelThickness: 0.01,
        bevelSize: 0.01,
        bevelSegments: 3
    });

    // Yozuv materiali
    const customTextMaterial1 = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Qora rangdagi yozuv
    const customTextMesh1 = new THREE.Mesh(customTextGeometry, customTextMaterial1);

    // Yozuvning pozitsiyasini o'rnatish
    customTextMesh1.position.set(0, 0.1, 30); // Yerni asos qilib yozuvni joylashtirish
    customTextMesh1.rotation.x = -Math.PI / 2; // Yerni parallel qilish uchun x o'qida 90 daraja aylantirish

    // Yozuvni sahnaga qo'shish
    scene.add(customTextMesh1);
});








    animate(); // Animatsiyani boshlash
  </script>
</body>
</html>
